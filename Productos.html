<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <link
      rel="icon"
      type="image/png"
      href="https://raw.githubusercontent.com/BeliMuga/PacksMonserratAlmazan/refs/heads/main/images/favicon.jpg"
    />
    <title>Escoge tus Lotes</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        font-family: Segoe UI, Tahoma, Geneva,
          Verdana, sans-serif, system-ui;
      }

      html,
      body {
        min-height: 100vh; /* at least one viewport tall */
        margin: 0; /* remove default margin */
      }

      body {
        background-image: url("https://raw.githubusercontent.com/BeliMuga/PacksMonserratAlmazan/refs/heads/main/images/imgBckGnd3.svg");
        background-repeat: repeat-x; /* repeat only leftâ†’right */
        background-size: 50% auto; /* each copy takes Â½ screen width â†’ 2 copies visible */
        background-position: top left;
        background-attachment: fixed;
        background-color: #070540;
      }

      :root {
        --accent: #e60909;
        --grey: #f5f5f5;
        --radius: 12px;
        --shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        --transition: 0.25s ease-in-out;
      }

      .logo {
        height: 50vh;
        padding-bottom: 1.5em;
      }

      .bundle-intro {
        display: flex;
        flex-direction: column;
        text-align: center; /* centers text */
        width: 70vw; /* keeps text readable */
        margin: 2rem auto; /* vertical spacing + horizontal centering */
        font-weight: normal; /* ensures no bold */
        color: var(--grey); /* nice dark gray */
        line-height: 1.6; /* comfortable line spacing */
      }

      .bundle-intro h2 {
        font-size: 2rem;
        margin-bottom: 1rem;
        font-weight: normal;
      }

      .bundle-intro h3 {
        font-size: 1.1rem;
        font-weight: normal;
      }
      #buttonTr {
        background: var(--accent);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 0.4rem 1.2rem;
        font-weight: 600;
        font-size: 1.1em;
        cursor: pointer;
        transition: background 0.25s ease-in-out;
        align-self: flex-end;
      }

      p {
        display: inline;
        background-color: var(--grey);
        color: var(--accent);
        padding: 0.2em 0.4em;
        border-radius: 0.4em;
      }

      /* ----------  grid  ---------- */
      .grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 8rem;
        max-width: 1200px;
        margin: auto;
        justify-content: center;
      }

      @media (max-width: 900px) {
        .grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }
      @media (max-width: 600px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }

      /* ----------  card  ---------- */
      .json-card {
        background: #fff;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        transition: transform var(--transition),
          box-shadow var(--transition);
        overflow: hidden;
      }
      .json-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 28px
          rgba(0, 0, 0, 0.12);
      }

      .json-card.featured {
        display: flex;
        flex-direction: row;
        align-items: center;
        grid-column: span 2; /* spans both columns */
        width: 80vw;
        min-height: 700px; /* adjust height as needed */
        gap: 2rem; /* space between image + content */
        padding: 3em;
      }

      .json-card.featured .bundle-img {
        width: 50%;
      }

      .json-card.featured .title {
        align-self: flex-start; /* stick to the top of the flex line */
      }

      .json-card.featured .description {
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      .badge-strip {
        grid-column: span 2;
        color: var(--grey);
        font-size: 2em;
        text-align: center;
      }

      /* ----------  content  ---------- */
      .title {
        font-size: 1.6rem;
        text-align: center;
        font-weight: normal;
        margin-bottom: 0.5rem;
        font-weight: bold;
      }

      .unit {
        font-size: 0.875rem;
        color: #666;
        margin-bottom: 1rem;
      }

      .lines {
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
        font-size: 0.9em;
      }

      .prod {
        font-weight: 500;
      }

      .total {
        text-align: center;
        font-weight: 600;
      }

      .foot {
        font-size: 0.875rem;
        color: #666;
      }
      .total-bar {
        position: sticky;
        bottom: 0;
        background: #fff;
        margin-top: 1em;
        border-top: 1px solid #ddd;
        padding: 1rem;
        text-align: center;
        font-weight: 600;
      }

      .line {
        display: grid;
        grid-template-columns: 5fr 1fr 2fr 2fr;
        align-items: center;
        padding: 0.25rem 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .lines-header {
        display: grid;
        grid-template-columns: 5fr 1fr 2fr 2fr;
        font-size: 0.85rem;
        color: #888;
        font-weight: 500;
        margin-bottom: 0.3rem;
        text-align: center;
      }

      .price,
      .totals,
      .qty {
        text-align: center;
      }
      .cart-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 0.5rem;
      }

      .qty-ctrl {
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }

      .qty-ctrl button {
        background: #f8f8f8;
        border: 1px solid #ccc;
        border-radius: 6px;
        padding: 0.2rem 0.6rem;
        cursor: pointer;
        transition: background 0.2s ease;
      }

      .qty-ctrl button:hover {
        background: #eee;
      }

      button {
        padding: 0.3rem 0.6rem;
        cursor: pointer;
      }

      .cart-row .foot {
        min-width: 80px;
        text-align: left;
      }

      .cart-row .qty-ctrl {
        min-width: 80px;
      }

      .cart-row .total {
        min-width: 80px;
        text-align: right;
      }

      .add {
        background: var(--accent);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 0.4rem 1.2rem;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.25s ease-in-out;
      }

      #show-cart {
        background: var(--accent);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 0.4rem 1.2rem;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.25s ease-in-out;
      }

      .add:hover {
        background: #e63b3b;
      }

      .json-card .bundle-img {
        width: 100%;
        height: auto; /* keeps aspect ratio */
        display: block; /* removes inline spacing below image */
        margin: 0;
        padding: 0;
      }

      /* ----------  empty-state  ---------- */
      .json-card.empty {
        opacity: 0.45;
      }
    </style>
  </head>

  <body>
    <div class="bundle-intro">
      <button id="buttonTr">ES</button>
      <div class="logo">
        <img
          class="logo"
          src="https://raw.githubusercontent.com/BeliMuga/PacksMonserratAlmazan/refs/heads/main/images/logo.png"
          alt="logo"
        />
      </div>
      <h1 class="tr" data-key="main_title">
        Volem celebrar aquest nadal amb tu!
      </h1>
      <h2 class="tr" data-key="sub_title">
        Hem disenyat els segÃ¼ents packs perquÃ¨ els
        podeu gaudir
      </h2>
    </div>

    <div class="grid"></div>
    <footer class="total-bar">
      <button id="show-cart" type="button">
        <span class="tr" data-key="show_btn"
          >MOSTRAR</span
        >
      </button>
      <h3>
        <span class="tr" data-key="total_label"
          >Total Productes:</span
        >
        <span id="grand-total">0 â‚¬</span>
      </h3>
    </footer>
    <script>
      /* ----------  logic (30 lines)  ---------- */
      const data = {
        PackNocheBuena: {
          product1: {
            name: "Espatlla iberica cebo peÃ§a",
            precio: "77 â‚¬",
            unidad: "1",
            total: "77 â‚¬",
          },
          product2: {
            name: "Fuet peÃ§a",
            precio: "3 â‚¬",
            unidad: "1",
            total: "3 â‚¬",
          },
          product3: {
            name: "Llonganisa peÃ§a",
            precio: "3.53 â‚¬",
            unidad: "1",
            total: "3.53 â‚¬",
          },
          product4: {
            name: "CuÃ±a queso cabra",
            precio: "6 â‚¬",
            unidad: "1",
            total: "6 â‚¬",
          },
          product5: {
            name: "CuÃ±a queso oveja",
            precio: "6 â‚¬",
            unidad: "1",
            total: "6 â‚¬",
          },
          product6: {
            name: "Vi negre mirapallars merlot 14 mesos crianÃ§a roure",
            precio: "15 â‚¬",
            unidad: "1",
            total: "15 â‚¬",
          },
          product7: {
            name: "Vi blanc artesia garnatxa blanca",
            precio: "15 â‚¬",
            unidad: "1",
            total: "15 â‚¬",
          },
          product8: {
            name: "Cava bohigas reserva bnature 18 mesos",
            precio: "18 â‚¬",
            unidad: "1",
            total: "18 â‚¬",
          },
          product9: {
            name: "Oli cuadrat valley bio 500ml",
            precio: "15 â‚¬",
            unidad: "1",
            total: "15 â‚¬",
          },
          product10: {
            name: "Caixa de cartrÃ³",
            precio: "4 â‚¬",
            unidad: "1",
            total: "4 â‚¬",
          },
          subTotal: 155.0,
        },
        PackBelÃ©n: {
          product1: {
            name: "CuÃ±a queso cabra",
            precio: "6 â‚¬",
            unidad: "1",
            total: "6 â‚¬",
          },
          product2: {
            name: "CuÃ±a queso oveja",
            precio: "6 â‚¬",
            unidad: "1",
            total: "6 â‚¬",
          },
          product3: {
            name: "Kimchi 300g",
            precio: "7 â‚¬",
            unidad: "1",
            total: "7 â‚¬",
          },
          product4: {
            name: "Llonganisa llescada 100g",
            precio: "2 â‚¬",
            unidad: "2",
            total: "4 â‚¬",
          },
          product5: {
            name: "XoriÃ§ llescat 100g",
            precio: "2 â‚¬",
            unidad: "2",
            total: "4 â‚¬",
          },
          product6: {
            name: "Salchichon llescat 100g",
            precio: "2 â‚¬",
            unidad: "2",
            total: "4 â‚¬",
          },
          product7: {
            name: "Llom iberic llescat 100g",
            precio: "10 â‚¬",
            unidad: "2",
            total: "10 â‚¬",
          },
          product8: {
            name: "Espatlla iberica llescat 100g",
            precio: "6.20 â‚¬",
            unidad: "2",
            total: "12.40 â‚¬",
          },
          product9: {
            name: "Vi negre Idrias crianza 2021 6 meses roble frances",
            precio: "10 â‚¬",
            unidad: "1",
            total: "10 â‚¬",
          },
          product10: {
            name: "Vi blanc artesia garnatxa blanca",
            precio: "15 â‚¬",
            unidad: "1",
            total: "15 â‚¬",
          },
          product11: {
            name: "Oli cuadrat valley bio 500ml",
            precio: "15 â‚¬",
            unidad: "1",
            total: "15 â‚¬",
          },
          product12: {
            name: "Caixa de cartrÃ³",
            precio: "4 â‚¬",
            unidad: "1",
            total: "4 â‚¬",
          },
          subTotal: 98.0,
        },
        PackReisMags: {
          product1: {
            name: "Espatlla iberica cebo peÃ§a",
            precio: "77 â‚¬",
            unidad: "1",
            total: "77 â‚¬",
          },

          product2: {
            name: "Vi negre Idrias crianza 2021 6 meses roble frances",
            precio: "10 â‚¬",
            unidad: "1",
            total: "10 â‚¬",
          },

          product3: {
            name: "Caixa de cartrÃ³",
            precio: "4 â‚¬",
            unidad: "1",
            total: "4 â‚¬",
          },
          subTotal: 91.0,
        },

        PackCagaTiÃ³: {
          product1: {
            name: "Espatlla iberica llescat 100g",
            precio: "6.20 â‚¬",
            unidad: "10",
            total: "6.20 â‚¬",
          },
          product2: {
            name: "Vi negre Idrias crianza 2021 6 meses roble frances",
            precio: "10 â‚¬",
            unidad: "1",
            total: "10 â‚¬",
          },
          product3: {
            name: "Caixa de cartrÃ³",
            precio: "4 â‚¬",
            unidad: "1",
            total: "4 â‚¬",
          },
          subTotal: 76.0,
        },
      };

      const dict = {
        ca: {
          // original Catalan
          main_title:
            "Volem celebrar aquest nadal amb tu!",
          sub_title:
            "Hem dissenyat els segÃ¼ents packs perquÃ¨ els podeu gaudir",
          show_btn: "MOSTRAR",
          badge_1: "Tenim packs HALAL a mida",
          badge_2:
            "Repartim a tots els direccions que puguis tenir",
          total_label: "Total Productes",
          invoice_hdr: "FACTURA TEMPORAL:\n\n",
          invoice_line: (b, q, t) =>
            `${b} â†’ Quantitat: ${q} Total: â‚¬${t.toFixed(
              2
            )}\n`,
          total_footer: "\nTotal ReimpressiÃ³: â‚¬",
          reprint_note:
            "\n\nAquesta Ã©s una reimpresiÃ³ temporal; imprimeix la pantalla per guardar-la.",
        },
        es: {
          // Spanish
          main_title:
            "Â¡Queremos celebrar estas Navidades contigo!",
          sub_title:
            "Hemos diseÃ±ado los siguientes packs para que puedas disfrutarlos",
          show_btn: "MUESTRA",
          badge_1: "Tenemos packs HALAL a medida",
          badge_2:
            "Repartimos a todas las direcciones que puedas tener",
          total_label: "Total Productos",
          invoice_hdr: "FACTURA TEMPORAL:\n\n",
          invoice_line: (b, q, t) =>
            `${b} â†’ Cantidad: ${q} Total: â‚¬${t.toFixed(
              2
            )}\n`,
          total_footer: "\nTotal ReimpresiÃ³n: â‚¬",
          reprint_note:
            "\n\nEsta es una reimpresiÃ³n temporal; imprime la pantalla para guardarla.",
        },
      };

      let currentLang = "ca";

      function translatePage(lang = "ca") {
        document
          .querySelectorAll(".tr")
          .forEach((el) => {
            const key = el.dataset.key;
            el.textContent = dict[lang][key];
          });
      }

      document
        .getElementById("buttonTr")
        .addEventListener("click", (e) => {
          currentLang =
            currentLang === "ca" ? "es" : "ca";
          translatePage(currentLang);
          e.target.textContent =
            currentLang === "ca" ? "ES" : "CAT";
        });

      const cardsHTML = Object.entries(data)
        .map(([bundleName, bundle]) => {
          const lines = Object.entries(bundle)
            .filter(([k]) =>
              k.startsWith("product")
            )
            .map(
              ([key, p]) => `
                  <div class="line">
                    <span class="prod">${p.name}</span>
                    <span class="qty">${p.unidad}</span>
                    <span class="price">${p.precio}</span>
                    <span class="totals">${p.total}</span>
                  </div>`
            )
            .join("");
          const imgSrc = `https://raw.githubusercontent.com/BeliMuga/PacksMonserratAlmazan/main/images/${bundleName}.jpg`;

          const bundleTitle = bundleName.replace(
            /([a-z])([A-Z])/g,
            "$1 $2"
          );
          const isFeatured =
            bundleName === "PackNocheBuena";

          return `
             <article class="json-card${
               isFeatured ? " featured" : ""
             }">
                <h2 class="title">${bundleTitle}</h2>
                <img class="bundle-img" src="${imgSrc}" alt="${bundleName}">
                <div class="description">

                <div class="lines-header"> <span></span><span>Qty</span><span>Price</span><span>Total</span> </div>
                <div class="lines">${lines}</div>
                <div class="cart-row" data-key="${bundleName}" data-subtotal="${
            bundle.subTotal
          }">
                  <div class="foot">${
                    Object.keys(bundle).filter(
                      (k) =>
                        k.startsWith("product")
                    ).length
                  } products</div>

                  <div class="qty-ctrl">
                    <button class="dec">-</button>
                    <span class="qty">0</span>
                    <button class="inc">+</button>
                  </div>

                  <span class="total">${
                    bundle.subTotal
                  } â‚¬</span>

                </div>
                </div>


              </article>
              ${
                isFeatured
                  ? `
      <div class="badge-strip">
        <p class="tr" data-key="badge_1">Tenim packs HALAL a mida</p>
        <br>
        <br>
        <p class="tr" data-key="badge_2">Repartim a tots els direccions que puguis tenir</p>
      </div>`
                  : ""
              }
              `;
        })
        .join("");

      document.addEventListener(
        "DOMContentLoaded",
        () => {
          const grid =
            document.querySelector(".grid");
          grid.innerHTML = cardsHTML;

          // Attach event listeners via event delegation
          grid.addEventListener("click", (e) => {
            if (e.target.matches(".inc, .dec")) {
              const row =
                e.target.closest(".cart-row");
              const qtyEl =
                row.querySelector(".qty");
              const totalEl =
                row.querySelector(".total");
              const subTotal = parseFloat(
                row.dataset.subtotal
              );

              let qty = parseInt(
                qtyEl.textContent
              );
              if (
                e.target.classList.contains("inc")
              )
                qty++;
              else if (qty > 0) {
                qty--;
              }

              // Update qty display
              qtyEl.textContent = qty;

              // Update total only if qty > 0
              const newTotal = subTotal * qty;
              totalEl.dataset.value = newTotal; // always store the number

              // choose what the human sees
              totalEl.textContent =
                qty > 0
                  ? newTotal.toFixed(2) + " â‚¬"
                  : "0 â‚¬";

              recalcGrand();
            }
          });
        }
      );

      function recalcGrand() {
        let grand = 0;

        document
          .querySelectorAll(".cart-row .total")
          .forEach((el) => {
            grand += parseFloat(
              el.dataset.value || 0
            );
          });

        // update the on-screen total
        document.getElementById(
          "grand-total"
        ).textContent = grand.toFixed(2) + " â‚¬";
      }

      // ðŸ‘‡ only show alert when pressing the button
      document
        .getElementById("show-cart")
        .addEventListener("click", () => {
          translatePage(currentLang); // if you use this for static text
          let grand = 0;
          let summary =
            dict[currentLang].invoice_hdr; // start translated invoice

          document
            .querySelectorAll(".cart-row")
            .forEach((row) => {
              const bundle = row.dataset.key;
              const qty = parseInt(
                row.querySelector(".qty")
                  .textContent
              );
              const total = parseFloat(
                row.querySelector(".total")
                  .dataset.value || 0
              );

              if (qty > 0) {
                grand += total;
                // use your translation template
                summary += dict[
                  currentLang
                ].invoice_line(
                  bundle,
                  qty,
                  total
                );
              }
            });

          summary +=
            dict[currentLang].total_footer +
            grand.toFixed(2) +
            dict[currentLang].reprint_note;

          alert(summary);
          location.reload();
        });
    </script>
  </body>
</html>
